type: DataSetup
spec:
  name: basic-data-setup
  users:
  - bogdan
  - alice
  - bob
  - alex
  - victor
  - john
  groups:
  - finance-users
  - datascience-users
  - project-crowding-detection
  datasets:
  - sentinel-2-metadata-dataset
  role_bindings:
  - bogdan-global-permissions-admin
  endpoints:
    alluxio:
      server: alluxio
      rpcPort: 19999
      apiPort: 39999
    presto:
      server: presto-coordinator-0
      httpPort: 8080
    ranger:
      server: localhost
      port: 30800
      user: admin
      password: G0powerRangers
    gitea:
      server: localhost
      port: 30807
      token: 2b44b07e042ee9fe374e3eeebd2c9098468b5774
---
type: User
spec:
  unixname: bogdan
  firstName: Bogdan
  lastName: State
  email: bogdan@scie.nz
  phone: 555-1234
---
type: User
spec:
  unixname: john
  firstName: John
  lastName: State
  email: john@scie.nz
  phone: 555-1234
---
type: User
spec:
  unixname: alex
  firstName: A
  lastName: B
  email: alex@scie.nz
  phone: 555-1234
---
type: User
spec:
  unixname: victor
  firstName: A
  lastName: B
  email: victor@scie.nz
  phone: 555-1234
---
type: RoleBinding
spec:
  user_name: bogdan
  name: bogdan-global-permissions-admin
  role:
    type: GlobalPermissionsAdmin
    spec: {}
---
type: User
spec:
  unixname: alice
  firstName: Alice
  lastName: Johnson
  email: alice@scie.nz
  phone: 555-1235
---
type: User
spec:
  unixname: bob
  firstName: Bob
  lastName: Johnson
  email: bob@scie.nz
  phone: 555-1235
---
type: UserGroup
spec:
  name: finance-users
  members:
    - alice
  labels:
    department: finance
---
type: UserGroup
spec:
  name: datascience-users
  members:
    - bogdan
  labels:
    department: datascience
---
type: UserGroup
spec:
  name: project-crowding-detection
  members:
    - bogdan
  labels:
    project: crowding-detection
---
type: DataSet
spec:
  name: sentinel-2-metadata-dataset
  accessPolicies:
  - type: ApproveAccessSelector
    spec:
      matchLabels:
        department:
          - datascience
        project:
          - crowding-detection
  datumTemplates:
  - name: granule-datum
    type: KeyedStruct
    attributes:
    - name: granule_id
      type: KeyStringIdentifier
    - name: product_id
      type: NullableStringIdentifier
    - name: datatake_identifier
      type: NullableStringIdentifier
    - name: mgrs_tile
      type: NullableStringIdentifier
    - name: sensing_time
      type: NullablePOSIXTimestamp
    - name: total_size
      type: NullableInt64
    - name: cloud_cover
      type: NullableString
    - name: geometric_quality_flag
      type: NullableString
    - name: generation_time
      type: NullablePOSIXTimestamp
    - name: north_lat
      type: FloatLatitude
      comment: |
        Northern latitude of the tile`s bounding box.
    - name: south_lat
      type: FloatLatitude
      comment: |
        Southern latitude of the tile`s bounding box.
    - name: west_lon
      type: FloatLongitude
      comment: |
        Western longitude of the tile`s bounding box.
    - name: east_lon
      type: FloatLongitude
      comment: |
        Eastern longitude of the tile`s bounding box.
    - name: base_url
      type: URI
  assets:
    - type: StaticDataTable
      spec:
        name: sentinel-2-metadata-table
        setup:
          type: RemoteImportStorageSetup
          spec:
            remote:
              type: RemoteWebsiteStorage
              location:
                type: GCSLocation
                spec:
                  bucket: gcp-public-data-sentinel2
                  blob: index.csv.gz-backup
              layout:
                type: SingleFileLayout
              encoding:
                type: CSVEncoding
                spec:
                  compression:
                    type: GzipCompression
                  header:
                    type: UpperSnakeCaseCSVHeader
            local:
            - type: HiveTableStorage
              location:
                type: HiveAlluxioLocation
                spec:
                  path: 'sentinel2/metadata'
              layout:
                type: StaticHiveTableLayout
                spec: {}
              encoding:
                type: ORCEncoding
                spec: {}
        schema:
          type: TabularSchema
          spec:
            datumTemplateName: granule-datum
            attributes:
            - granule_id
            - product_id
            - datatake_identifier
            - mgrs_tile
            - sensing_time
            - total_size
            - cloud_cover
            - geometric_quality_flag
            - generation_time
            - north_lat
            - south_lat
            - west_lon
            - east_lon
            - base_url
---
